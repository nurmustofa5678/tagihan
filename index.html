<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <body>

<div style="max-width:360px;margin:80px auto;padding:25px;border:1px solid #ddd;border-radius:8px;font-family:Arial">

  <h2 style="text-align:center;">Login Pelanggan</h2>

  <label>Nomor Telepon</label>
  <input
    type="tel"
    id="no_hp"
    placeholder="08xxxxxxxxxx"
    style="width:100%;padding:10px;margin:10px 0;border:1px solid #ccc;border-radius:5px;"
  >

  <button
    onclick="login()"
    style="width:100%;padding:10px;background:#007bff;color:#fff;border:none;border-radius:5px;cursor:pointer;"
  >
    Login
  </button>

  <p id="pesan" style="margin-top:15px;text-align:center;"></p>

</div>

<script>
const CSV_URL = "datapelanggan.csv"; // file CSV satu folder

function login() {
  const nohp = document.getElementById("no_hp").value.trim();
  const pesan = document.getElementById("pesan");

  pesan.innerText = "Memeriksa data...";
  pesan.style.color = "black";

  if (!nohp) {
    pesan.innerText = "Nomor telepon wajib diisi";
    pesan.style.color = "red";
    return;
  }

  fetch(CSV_URL)
    .then(response => response.text())
    .then(text => {
      const rows = text.replace(/\r/g, "").split("\n");
      let ditemukan = false;

      for (let i = 1; i < rows.length; i++) {
        const kolom = rows[i].split(",");
        if (kolom.length < 1) continue;

        const hp = kolom[0].trim();
        const status = kolom[2]?.trim().toLowerCase();

        if (hp === nohp && status === "aktif") {
          ditemukan = true;
          break;
        }
      }

      if (ditemukan) {
        pesan.innerText = "Login berhasil";
        pesan.style.color = "green";
        localStorage.setItem("login_hp", nohp);
        // window.location.href = "menu.html";
      } else {
        pesan.innerText = "Nomor tidak terdaftar / tidak aktif";
        pesan.style.color = "red";
      }
    })
    .catch(err => {
      pesan.innerText = "Gagal membaca file CSV";
      pesan.style.color = "red";
      console.error(err);
    });
}
</script>


</body>

</body>
</html>